## Unit Testing


### Running unit tests

Unit tests are implemented with the help of the [Google's C++ test framework](https://github.com/google/googletest).
The tests source files are located under the `tests` directory as test_*.cpp.

You might also add an example in the `example` directory which will be also run as a test as defined by the current cmake configuration.

To run the test from the CLI first build vttv then call ctest using the command line:
`ctest --test-dir build`


To run specific tests you can use the ctest search option:
`ctest --test-dir build --verbose -R "reader"`

# Running coverage

Coverage is generated by `gcov` and some report can be generated by `lcov`.

1. Perform coverage (generates .gcda files):
`ctest --test-dir build -T Coverage`

1. Generate lcov file from .gcda files:

```shell
lcov --capture --directory build --output-file output/lcov_vt-tv_test.info
```

2. Remove lib, include and tests directories to cover only the source directories
```shell
lcov --remove output/lcov_vt-tv_test.info -o output/lcov_vt-tv_test_no_deps.info '*/lib/*' '/usr/include/*' '*/vtk/*' '*/tests/*'
```
3. Generate an HTML report
```shell
genhtml --prefix ./src --ignore-errors source ./output/lcov_vt-tv_test_no_deps.info --legend --title "$(git rev-parse HEAD)" --output-directory=output/lcov_vt-tv_html
```
